<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="components/style.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="components/header.js" type="text/javascript"></script>
<script src="components/navigation.js" type="text/javascript"></script>
<script src="components/footer.js" type="text/javascript"></script>
<link rel="icon" type="image/x-icon" href="./assets/misc/icon.png">

<header-component></header-component>

<body>
<navigation-component></navigation-component>

<table>
    <tr>
        <td width="1000">
          <hr>
          <br />
          <h3 style="text-align: center; font-weight:normal;">Patient-specific Digital Heart for Arrhythmia Ablation</h3>
        </td>
      </tr>

    <tr>
        <td>
            <p>The aim is to develop a digital twin of patient's heart which can simulate its electrical activation behoviors, to assist physicians during the atrial arrhythmia ablation surgeries. There are a lot of challenges, for more details please refer to the page of <u><a href="atrial_fibrillation_challenges.html">Atrial Fibrillation Ablation Challenges</a></u>.</p> 
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/heart_model_for_arrhythmia_ablation.jpg" style="width: 90%;">
            </div>

            <p>The overview process is: extract patient data to tune heart model parameters, initiate arrhythmia according to patient data, then solve the heart model equations to simulate patient-specific arrhythmias.</p>

            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/heart_modeling.PNG" style="width: 90%;">
            </div>

            <p>Below are the heart model equations. They calculate the activation action potentials. There are parameters that affect the shape of the action potential, and parameters that affect the activation propagation. These parameters are tuned locally. Every vertex of the mesh has its own set of parameter values.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/model_parameters.PNG" style="width: 80%;">
            </div>

            <p>To solve the heart model equations, the left atrium is spatially discretized by transforming the 3D triangular mesh into a set of Cartesian nodes. For each mesh vertex, Cartesian nodes are generated within a specified radius. Repeating this process for all vertices produces a distribution of Cartesian nodes that wraps around the mesh surface.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/create_nodes.PNG" style="width: 80%;">
            </div>

            <p>The heart model equations are discretized in time using the explicit Euler method. With some initial values at time 0, the values of the next time step can be computed.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/discretize_time.PNG" style="width: 60%;">
            </div>

            <p>To compute the diffusion term, no-flux boundary conditions are applied, and used a 19-node stencil. The action potential of the red node will be diffused into its 18 neighbors according to the diffusion coefficient matrices.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/compute_diffusion_term.PNG" style="width: 90%;">
            </div>

            <p>Here are examples of arrhythmia simulations. Focal arrhythmia: Activation originates at an abnormal location. Rotor arrhythmia: Spiral waves cause irregular heartbeat. Zigzag propagation: Complex scar distributions create activation tunnels of various conduction velocities. Atrial fibrillation: Chaotic activation waves that have no organizations.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/arrhythmia_simulations.gif" style="width: 70%;">
            </div>

            <p>The solution to the lack of fiber data is to compensate for it through diffusion coefficient tuning. Tuning is challenging: 1) Heart model is nonlinear. 2) Diffusion is influencing the neighbor nodes, not the immediate vicinities. 3) Sensitive to the initial guess values, adjustment steps, ending criteria, etc.</p>
            
            <p>An optimization process was developed to overcome the tuning challenges. Patient data are processed to obtain the true local activation times. A simulation is then run with an initial guess of diffusion values, and the simulation results are processed to obtain the simulated local activation times. These two sets of activation times are compared and the diffusion values are updated according to this comparison. New simulations are run and diffusion values are adjusted in each iteration. The tuning is done when the difference between patient activation time and simulation activation time is minimized. To accelerate the tuning process, the relation between conduction velocity and diffusion coefficient is exploited, which reduces the number of iterations required to reach the optimum. As illustrated in the figure below, scars are also accounted for. The figure on the left shows scar regions in red, and the figure on the right, shows a diffusion coefficient map, where red represents low conductivity. The red regions between these two figures are almost the same. Which means the tuning is accurate.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/diffusion_tuning.PNG" style="width: 90%;">
            </div>
            
            <p>The model achieved high accuracy in simulating arrhythmias. Experiments were run on seven patientsâ€™ left atria. For focal arrhythmia, an activation time accuracy of 96% was achieved.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/focal_lat_map.PNG" style="width: 90%;">
            </div>
            
            <p>For rotor arrhythmia, an activation time accuracy of 93% was achieved.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/rotor_lat_map.PNG" style="width: 90%;">
            </div>
            
            <p>The model was tested with 15 patient datasets to demonstrate its capability of accurately reproducing patient arrhythmias. The figures below show the results of 7 atrial tachycardia maps. An average activation time error of 10.97 ms was achieved, with an average correlation of 0.81.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/patient_sim_lat_maps_at.PNG" style="width: 90%;">
            </div>
            
            <p>These are the results of 8 sinus rhythm maps. An average activation time error of 5.47 ms was achieved, with an average correlation of 0.95. Sinus rhythm maps are helpful: oftentimes, a patient comes into the operating room in sinus rhythm, or undergoes cardioversion into sinus rhythm, to acquire a voltage map for assisting pulmonary vein isolation.</p>
            
            <div style="text-align: center;">
                <img src="assets/cyber_physical_systems_modeling/patient_sim_lat_maps_sr.PNG" style="width: 90%;">
            </div>
        </td>
    </tr>
</table>

<footer-component></footer-component>
</body>
</html>
